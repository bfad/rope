<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Validations &mdash; Rope 1.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Rope 1.0 documentation" href="../index.html" />
    <link rel="up" title="Welcome to Rope’s Users’ Guide!" href="index.html" />
    <link rel="next" title="Utility Methods" href="rope_utilities.html" />
    <link rel="prev" title="Rope User" href="rope_user.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="rope_utilities.html" title="Utility Methods"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="rope_user.html" title="Rope User"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Rope 1.0 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Welcome to Rope&#8217;s Users&#8217; Guide!</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="validations">
<h1>Validations<a class="headerlink" href="#validations" title="Permalink to this headline">¶</a></h1>
<p>Rope provides a way to easily create custom validations on the data members of
your own custom types. Once your type imports and implements
<tt class="docutils literal"><span class="pre">trait_rope_objectValidator</span></tt> you can easily ascertain whether an object is
setup correclty by calling the <tt class="docutils literal"><span class="pre">trait_rope_objectValidator-&gt;ropeIsValid</span></tt>
method. This section of the documentation will walk you through how to implement
the trait and use some of the validation methods that come with the library.</p>
<div class="section" id="implementing-trait-rope-objectvalidator">
<h2>Implementing trait_rope_objectValidator<a class="headerlink" href="#implementing-trait-rope-objectvalidator" title="Permalink to this headline">¶</a></h2>
<p>To implement <tt class="docutils literal"><span class="pre">trait_rope_objectValidator</span></tt>, you must have a member method that
returns a map. It expects that the keys to the map are either strings or tags
that correspond to data member getter methods you want to test. The values for
the keys in the map consist of the validator that will be run.</p>
<p>Validators can be either of type <tt class="docutils literal"><span class="pre">capture</span></tt> or <tt class="docutils literal"><span class="pre">memberstream</span></tt> and will be
passed the value produced by calling the method specified by the map key. If the
value passes the validation, <tt class="docutils literal"><span class="pre">void</span></tt> will be returned. If it fails, it returns
a string with a message of what failed.</p>
<p>Below is a small type that implements <tt class="docutils literal"><span class="pre">trait_rope_objectValidator</span></tt> with a
validator (<tt class="docutils literal"><span class="pre">rv_notEmpty</span></tt>) that tests that a course object has a name:</p>
<div class="highlight-python"><pre>define course =&gt; type {
    trait { import trait_rope_objectValidator }

    data public name

    public ropeValidations =&gt; map(::name = rv_notEmpty)
}</pre>
</div>
</div>
<div class="section" id="built-in-validators">
<h2>Built-in Validators<a class="headerlink" href="#built-in-validators" title="Permalink to this headline">¶</a></h2>
<p>The rope validator library comes with a bunch of predefined validators that can
be used by invoking one of the methods detailed below. The documentation that
follows will detail configuration options that can be passed to the method to
setup the validator as well as what the returned validator checks. Note that
each method allows you to specify the message string to return upon failure by
passing in the string to the <tt class="docutils literal"><span class="pre">-message</span></tt> named parameter.</p>
<dl class="method">
<dt id="rv_notEmpty">
<tt class="descname">rv_notEmpty</tt><big>(</big><em>-message::string=`Field can not be empty`</em><big>)</big><a class="headerlink" href="#rv_notEmpty" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a validator that passes as long as the value is not <tt class="docutils literal"><span class="pre">void</span></tt>,
<tt class="docutils literal"><span class="pre">null</span></tt>, or has a <tt class="docutils literal"><span class="pre">size</span></tt> member method return 0.</p>
</dd></dl>

<dl class="method">
<dt id="rv_containedIn">
<tt class="descname">rv_containedIn</tt><big>(</big><em>list</em>, <em>-message::string=`Field must be one of ` + #list-&gt;join('</em>, <em>')</em><big>)</big><a class="headerlink" href="#rv_containedIn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="rv_notContainedIn">
<tt class="descname">rv_notContainedIn</tt><big>(</big><em>list</em>, <em>-message::string=`Field must not be one of ` + #list-&gt;join('</em>, <em>')</em><big>)</big><a class="headerlink" href="#rv_notContainedIn" title="Permalink to this definition">¶</a></dt>
<dd><p>Requires a container of values passed as the first argument. Depending on the
method, creates a validator that passes if the value is or is not contained
in the values passed in to the &#8220;list&#8221; parameter.</p>
</dd></dl>

<dl class="method">
<dt id="rv_inRange">
<tt class="descname">rv_inRange</tt><big>(</big><em>series::generateSeries</em>, <em>-message::string=`Field must be between ` + #series-&gt;from + ` and ` + #series-&gt;to</em><big>)</big><a class="headerlink" href="#rv_inRange" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="rv_notInRange">
<tt class="descname">rv_notInRange</tt><big>(</big><em>series::generateSeries</em>, <em>-message::string=`Field must not be between ` + #series-&gt;from + ` and ` + #series-&gt;to</em><big>)</big><a class="headerlink" href="#rv_notInRange" title="Permalink to this definition">¶</a></dt>
<dd><p>Requires a range be passed as the first argument. Depending on the method, it
returns a validator that passes if the value is inside or is outside of the
given range.</p>
</dd></dl>

<dl class="method">
<dt id="rv_greaterThan">
<tt class="descname">rv_greaterThan</tt><big>(</big><em>bound::integer</em>, <em>-message::string=`Field must be greater than ` + #bound</em><big>)</big><a class="headerlink" href="#rv_greaterThan" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<tt class="descname">rv_greaterThan</tt><big>(</big><em>bound::decimal</em>, <em>-message::string=`Field must be greater than ` + #bound</em><big>)</big></dt>
<dd></dd></dl>

<dl class="method">
<dt id="rv_lessThan">
<tt class="descname">rv_lessThan</tt><big>(</big><em>bound::integer</em>, <em>-message::string=`Field must be less than ` + #bound</em><big>)</big><a class="headerlink" href="#rv_lessThan" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<tt class="descname">rv_lessThan</tt><big>(</big><em>bound::decimal</em>, <em>-message::string=`Field must be less than ` + #bound</em><big>)</big></dt>
<dd><p>Requires either an integer or decimal value to be compared to the value being
validated. Depending on the method, it returns a validator that passes if the
value is greater than or less than the value passed to &#8220;bound&#8221;.</p>
</dd></dl>

<dl class="method">
<dt id="rv_isValue">
<tt class="descname">rv_isValue</tt><big>(</big><em>expected</em>, <em>-message::string=`Field must be ` + #expected</em><big>)</big><a class="headerlink" href="#rv_isValue" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="rv_isNotValue">
<tt class="descname">rv_isNotValue</tt><big>(</big><em>expected</em>, <em>-message::string=`Field must not be ` + #expected</em><big>)</big><a class="headerlink" href="#rv_isNotValue" title="Permalink to this definition">¶</a></dt>
<dd><p>Requires a value to compare for equality (<tt class="docutils literal"><span class="pre">==</span></tt> or <tt class="docutils literal"><span class="pre">!=</span></tt>) to the value
being validated. Depending on the method, it returns a validator that passes
if the value is equal to or not equal to the value passed to &#8220;expected&#8221;.</p>
</dd></dl>

<dl class="method">
<dt id="rv_isExactly">
<tt class="descname">rv_isExactly</tt><big>(</big><em>expected</em>, <em>-message::string=`Field must be ` + #expected</em><big>)</big><a class="headerlink" href="#rv_isExactly" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="rv_isNotExactly">
<tt class="descname">rv_isNotExactly</tt><big>(</big><em>expected</em>, <em>-message::string=`Field must not be ` + #expected</em><big>)</big><a class="headerlink" href="#rv_isNotExactly" title="Permalink to this definition">¶</a></dt>
<dd><p>Requires a value to compare for exact equality (<tt class="docutils literal"><span class="pre">===</span></tt> or <tt class="docutils literal"><span class="pre">!==</span></tt>) to the
value being validated. Depending on the method, it returns a validator that
passes if the value is exactly equal to or not exactly equal to the value
passed to &#8220;expected&#8221;.</p>
</dd></dl>

<dl class="method">
<dt id="rv_isA">
<tt class="descname">rv_isA</tt><big>(</big><em>expected::tag</em>, <em>message::string=`Field must be a ` + #expected</em><big>)</big><a class="headerlink" href="#rv_isA" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="rv_isNotA">
<tt class="descname">rv_isNotA</tt><big>(</big><em>expected::tag</em>, <em>message::string=`Field must not be a ` + #expected</em><big>)</big><a class="headerlink" href="#rv_isNotA" title="Permalink to this definition">¶</a></dt>
<dd><p>Requires a tag to be used for type comparison. Depending on the method, it
returns a validator that passes if the value is or is not of the specified
type.</p>
</dd></dl>

</div>
<div class="section" id="custom-validators">
<h2>Custom Validators<a class="headerlink" href="#custom-validators" title="Permalink to this headline">¶</a></h2>
<p>You can create your own custom validators by specifying a <tt class="docutils literal"><span class="pre">capture</span></tt> as the
value in the &#8220;ropeValidators&#8221; map. (You can also create your own methods that
return either a <tt class="docutils literal"><span class="pre">capture</span></tt> or <tt class="docutils literal"><span class="pre">memberstream</span></tt> and invoke those methods to get
the custom validator.) The example below tests that the value stored in
&#8220;squaredNumber&#8221; is in fact the square of an integer. The value being validated
will be passed to the capture as the first parameter, so <tt class="docutils literal"><span class="pre">#1</span></tt> must be used to
access it.</p>
<div class="highlight-python"><pre>define myType =&gt; type {
    trait { import trait_rope_objectValidator }

    data public squaredNumber

    public ropeValidations =&gt; map(
        ::name = {
            math_sqrt(#1) != integer(math_sqrt(#1))
               ? return `Should be the value of a whole number squared`
        }
    )
}</pre>
</div>
</div>
<div class="section" id="using-built-in-validators-inside-custom-validators">
<h2>Using Built-in Validators Inside Custom Validators<a class="headerlink" href="#using-built-in-validators-inside-custom-validators" title="Permalink to this headline">¶</a></h2>
<p>Each of the built-in validators has a form that can be used inside a custom
validator. Just call the validator method with the value you want to check as
the first argument. Instead of returning the validation it will call it on the
value passed in. In the example below, the &#8220;myDate&#8221; type has a custom validator
for the &#8220;day&#8221; data member that checks that it is in the correct range given the
month.</p>
<div class="highlight-python"><pre>define myDate =&gt; type {
    trait { import trait_rope_objectValidator }

    data
        public month
        public day

    public ropeValidations =&gt; map(
        ::month = rv_inRange(1 to 12),
        ::day   = {
            local(value) = #1
            match(.month) =&gt; {
            case(2)
                return rv_inRance(#value, 1 to 29)

            case(1, 3, 5, 7, 8, 10, 12)
                return rv_inRance(#value, 1 to 31)

            case
                return rv_inRance(#value, 1 to 30)
            }
        }
    )
}</pre>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Validations</a><ul>
<li><a class="reference internal" href="#implementing-trait-rope-objectvalidator">Implementing trait_rope_objectValidator</a></li>
<li><a class="reference internal" href="#built-in-validators">Built-in Validators</a></li>
<li><a class="reference internal" href="#custom-validators">Custom Validators</a></li>
<li><a class="reference internal" href="#using-built-in-validators-inside-custom-validators">Using Built-in Validators Inside Custom Validators</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="rope_user.html"
                        title="previous chapter">Rope User</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="rope_utilities.html"
                        title="next chapter">Utility Methods</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/user_guide/rope_validate.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="rope_utilities.html" title="Utility Methods"
             >next</a> |</li>
        <li class="right" >
          <a href="rope_user.html" title="Rope User"
             >previous</a> |</li>
        <li><a href="../index.html">Rope 1.0 documentation</a> &raquo;</li>
          <li><a href="index.html" >Welcome to Rope&#8217;s Users&#8217; Guide!</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Brad Lindsay.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b3.
    </div>
  </body>
</html>